"""
Smart Language Detector - Hybrid approach
Uses langdetect for most languages, custom detection for Devanagari conflicts
Enhanced with extensive word libraries for better Devanagari language detection
"""

from langdetect import detect, DetectorFactory
from langdetect.lang_detect_exception import LangDetectException
import re

# For consistent results
DetectorFactory.seed = 0

class SmartLanguageDetector:
    def __init__(self):
        # Languages that langdetect handles well
        self.langdetect_langs = ['bn', 'ta', 'te', 'ml', 'kn', 'pa', 'or', 'as', 'ur', 'si', 'en']
        
        # Devanagari script languages that need custom detection
        self.devanagari_langs = ['hi', 'mr', 'gu', 'sa', 'ne']  # Hindi, Marathi, Gujarati, Sanskrit, Nepali
        
        # Enhanced custom indicators for Devanagari language distinction with extensive word libraries
        self.devanagari_indicators = {
            'hi': {  # Hindi - Common words and phrases
                # High-weight indicators (very common in Hindi)
                'рд╣реИ': 5, 'рд╣реИрдВ': 5, 'рд╣реВрдБ': 5, 'рд╣реВрдБ': 5, 'рд╣реЛ': 4, 'рд╣реЛрдЧрд╛': 4, 'рд╣реЛрдЧреА': 4, 'рд╣реЛрдВрдЧреЗ': 4,
                'рдХреНрдпрд╛': 4, 'рдХрдм': 3, 'рдХрд╣рд╛рдБ': 3, 'рдХреИрд╕реЗ': 3, 'рдХрд┐рддрдирд╛': 3, 'рдХрд┐рддрдиреА': 3, 'рдХрд┐рддрдиреЗ': 3,
                'рдпрд╣': 3, 'рдпреЗ': 3, 'рд╡рд╣': 3, 'рд╡реЗ': 3,
                'рдореИрдВ': 4, 'рдореЗрд░рд╛': 3, 'рдореЗрд░реА': 3, 'рдореЗрд░реЗ': 3, 'рд╣рдо': 3, 'рд╣рдорд╛рд░рд╛': 3, 'рд╣рдорд╛рд░реА': 3, 'рд╣рдорд╛рд░реЗ': 3,
                'рддреБрдо': 4, 'рддреБрдореНрд╣рд╛рд░рд╛': 3, 'рддреБрдореНрд╣рд╛рд░реА': 3, 'рддреБрдореНрд╣рд╛рд░реЗ': 3, 'рдЖрдк': 4, 'рдЖрдкрдХрд╛': 3, 'рдЖрдкрдХреА': 3, 'рдЖрдкрдХреЗ': 3,
                
                # Medium-weight indicators (common but also appear in other languages)
                'рдХреЛ': 2, 'рд╕реЗ': 2, 'рдиреЗ': 2, 'рдкрд░': 2, 'рдореЗрдВ': 2, 'рдХрд╛': 2, 'рдХреА': 2, 'рдХреЗ': 2,
                'рднреА': 2, 'рддрдХ': 2, 'рд▓рд┐рдП': 2, 'рдФрд░': 2, 'рд▓реЗрдХрд┐рди': 2, 'рдпрд╛': 2, 'рд╡': 2,
                'рдирд╣реАрдВ': 3, 'рди': 2, 'рд╣рд╛рдБ': 3, 'рдЬреА': 2,
                
                # Low-weight indicators (common words)
                'рдерд╛': 1, 'рдереА': 1, 'рдереЗ': 1, 'рдЧрдпрд╛': 1, 'рдЧрдИ': 1, 'рдЧрдП': 1, 'рдЧрдпреА': 1,
                'рдХрд░': 1, 'рдХрд░рддрд╛': 1, 'рдХрд░рддреА': 1, 'рдХрд░рддреЗ': 1, 'рдХрд░реЗрдВ': 1, 'рдХрд░рдирд╛': 1, 'рдХрд░рдиреЗ': 1,
                'рджреЗрдЦ': 1, 'рджреЗрдЦрддрд╛': 1, 'рджреЗрдЦрддреА': 1, 'рджреЗрдЦрддреЗ': 1, 'рджреЗрдЦрдирд╛': 1, 'рджреЗрдЦрдиреЗ': 1,
                'рдЬрд╛рдирд╛': 1, 'рдЬрд╛рддрд╛': 1, 'рдЬрд╛рддреА': 1, 'рдЬрд╛рддреЗ': 1, 'рдЬрд╛рдПрдБ': 1, 'рдЬрд╛рдиреЗ': 1,
                'рдЖрдирд╛': 1, 'рдЖрддрд╛': 1, 'рдЖрддреА': 1, 'рдЖрддреЗ': 1, 'рдЖрдПрдБ': 1, 'рдЖрдиреЗ': 1,
                'рд╕рдХрддрд╛': 1, 'рд╕рдХрддреА': 1, 'рд╕рдХрддреЗ': 1, 'рд╕рдХрддреА': 1, 'рд╕рдХрддреЗ': 1, 'рд╕рдХрддреЗ рд╣реИрдВ': 1,
                'рдкрдбрд╝рддрд╛': 1, 'рдкрдбрд╝рддреА': 1, 'рдкрдбрд╝рддреЗ': 1, 'рдкрдбрд╝рдирд╛': 1, 'рдкрдбрд╝рдиреЗ': 1,
                'рдЪрд╛рд╣рд┐рдП': 1, 'рдЪрд╛рд╣рддрд╛': 1, 'рдЪрд╛рд╣рддреА': 1, 'рдЪрд╛рд╣рддреЗ': 1, 'рдЪрд╛рд╣рд┐рдП': 1,
                'рджреЗ': 1, 'рджреЗрддрд╛': 1, 'рджреЗрддреА': 1, 'рджреЗрддреЗ': 1, 'рджреЗрдирд╛': 1, 'рджреЗрдиреЗ': 1,
                'рд▓реЗ': 1, 'рд▓реЗрддрд╛': 1, 'рд▓реЗрддреА': 1, 'рд▓реЗрддреЗ': 1, 'рд▓реЗрдирд╛': 1, 'рд▓реЗрдиреЗ': 1,
                'рдЦрд╛рдирд╛': 1, 'рдЦрд╛рддрд╛': 1, 'рдЦрд╛рддреА': 1, 'рдЦрд╛рддреЗ': 1, 'рдЦрд╛рдиреЗ': 1,
                'рдкреАрдирд╛': 1, 'рдкреАрддрд╛': 1, 'рдкреАрддреА': 1, 'рдкреАрддреЗ': 1, 'рдкреАрдиреЗ': 1,
                'рд╕реЛрдирд╛': 1, 'рд╕реЛрддрд╛': 1, 'рд╕реЛрддреА': 1, 'рд╕реЛрддреЗ': 1, 'рд╕реЛрдиреЗ': 1,
                'рдмреЛрд▓рдирд╛': 1, 'рдмреЛрд▓рддрд╛': 1, 'рдмреЛрд▓рддреА': 1, 'рдмреЛрд▓рддреЗ': 1, 'рдмреЛрд▓рдиреЗ': 1,
                'рд╕реБрдирдирд╛': 1, 'рд╕реБрдирддрд╛': 1, 'рд╕реБрдирддреА': 1, 'рд╕реБрдирддреЗ': 1, 'рд╕реБрдирдиреЗ': 1,
                'рдЪрд▓рдирд╛': 1, 'рдЪрд▓рддрд╛': 1, 'рдЪрд▓рддреА': 1, 'рдЪрд▓рддреЗ': 1, 'рдЪрд▓рдиреЗ': 1,
                'рдЖрдЬ': 1, 'рдХрд▓': 1, 'рдкрд░рд╕реЛрдВ': 1,
                'рдпрд╣рд╛рдБ': 1, 'рд╡рд╣рд╛рдБ': 1, 'рдХрд╣реАрдВ': 1, 'рдХрд╣реАрдВ рднреА': 1, 'рдХрд╣реАрдВ рди рдХрд╣реАрдВ': 1,
                'рд╕рдм': 1, 'рд╕рднреА': 1, 'рдХреЛрдИ': 1, 'рдХреБрдЫ': 1,
                'рдЕрдЪреНрдЫрд╛': 1, 'рдЕрдЪреНрдЫреА': 1, 'рдЕрдЪреНрдЫреЗ': 1, 'рдмреБрд░рд╛': 1, 'рдмреБрд░реА': 1, 'рдмреБрд░реЗ': 1,
                'рдмрдбрд╝рд╛': 1, 'рдмрдбрд╝реА': 1, 'рдмрдбрд╝реЗ': 1, 'рдЫреЛрдЯрд╛': 1, 'рдЫреЛрдЯреА': 1, 'рдЫреЛрдЯреЗ': 1,
                'рдирдпрд╛': 1, 'рдирдИ': 1, 'рдирдП': 1, 'рдкреБрд░рд╛рдирд╛': 1, 'рдкреБрд░рд╛рдиреА': 1, 'рдкреБрд░рд╛рдиреЗ': 1,
                'рдПрдХ': 1, 'рджреЛ': 1, 'рддреАрди': 1, 'рдЪрд╛рд░': 1, 'рдкрд╛рдБрдЪ': 1,
                'рдЫрд╣': 1, 'рд╕рд╛рдд': 1, 'рдЖрда': 1, 'рдиреМ': 1, 'рджрд╕': 1,
                'рд╕реМ': 1, 'рд╣рдЬрд╝рд╛рд░': 1, 'рд▓рд╛рдЦ': 1, 'рдХрд░реЛрдбрд╝': 1,
                'рд░рдВрдЧ': 1, 'рдЦреБрд╢рдмреВ': 1, 'рд╕реНрд╡рд╛рдж': 1, 'рдЖрд╡рд╛рдЬрд╝': 1, 'рд░реВрдк': 1,
                'рдШрд░': 1, 'рджрд░рд╡рд╛рдЬрд╝рд╛': 1, 'рдЦрд┐рдбрд╝рдХреА': 1, 'рдХрдорд░рд╛': 1, 'рдмрд╛рдерд░реВрдо': 1,
                'рд╕реНрдХреВрд▓': 1, 'рдХреЙрд▓реЗрдЬ': 1, 'рдСрдлрд┐рд╕': 1, 'рдмрд╛рдЬрд╝рд╛рд░': 1, 'рджреБрдХрд╛рди': 1,
                'рдЧрд╛рдбрд╝реА': 1, 'рдмрд╕': 1, 'рдЯреНрд░реЗрди': 1, 'рд╡рд┐рдорд╛рди': 1, 'рд╕рд╛рдЗрдХрд┐рд▓': 1,
                'рдкреИрд╕рд╛': 1, 'рд░реБрдкрдпрд╛': 1, 'рдЕрдХреВрдд': 1, 'рдзрди': 1,
                'рдЦрд╛рдирд╛': 1, 'рдкрд╛рдиреА': 1, 'рджреВрдз': 1, 'рдЪрд╛рдп': 1, 'рдХреЙрдлреА': 1,
                'рд╕рдмреНрдЬрд╝реА': 1, 'рдлрд▓': 1, 'рдореАрдЯ': 1, 'рдЪрд╛рд╡рд▓': 1, 'рд░реЛрдЯреА': 1,
                'рдкрд░рд┐рд╡рд╛рд░': 1, 'рдорд╛рддрд╛-рдкрд┐рддрд╛': 1, 'рдмрдЪреНрдЪреЗ': 1, 'рднрд╛рдИ': 1, 'рдмрд╣рди': 1,
                'рджреЛрд╕реНрдд': 1, 'рдкрдбрд╝реЛрд╕реА': 1, 'рдЕрдЬрдирдмреА': 1, 'рд╢рддреНрд░реБ': 1,
                'рд╢рд╣рд░': 1, 'рдЧрд╛рдБрд╡': 1, 'рджреЗрд╢': 1, 'рд╡рд┐рджреЗрд╢': 1,
                'рд╕рдбрд╝рдХ': 1, 'рд░рд╛рд╕реНрддрд╛': 1, 'рдореЛрдбрд╝': 1, 'рдирд╛рд▓рд╛': 1, 'рдирджреА': 1,
                'рдкрд╣рд╛рдбрд╝': 1, 'рдкрд╣рд╛рдбрд╝реА': 1, 'рдШрд╛рдЯреА': 1, 'рдореИрджрд╛рди': 1, 'рдЬрдВрдЧрд▓': 1,
                'рд╕рдордп': 1, 'рджрд┐рди': 1, 'рд░рд╛рдд': 1, 'рд╕реБрдмрд╣': 1, 'рджреЛрдкрд╣рд░': 1, 'рд╢рд╛рдо': 1,
                'рд╕рдкреНрддрд╛рд╣': 1, 'рдорд╣реАрдирд╛': 1, 'рд╕рд╛рд▓': 1, 'рдЛрддреБ': 1,
                'рдЬрдирд╡рд░реА': 1, 'рдлрд░рд╡рд░реА': 1, 'рдорд╛рд░реНрдЪ': 1, 'рдЕрдкреНрд░реИрд▓': 1, 'рдордИ': 1, 'рдЬреВрди': 1,
                'рдЬреБрд▓рд╛рдИ': 1, 'рдЕрдЧрд╕реНрдд': 1, 'рд╕рд┐рддрдВрдмрд░': 1, 'рдЕрдХреНрдЯреВрдмрд░': 1, 'рдирд╡рдВрдмрд░': 1, 'рджрд┐рд╕рдВрдмрд░': 1,
                'рд╕реЛрдорд╡рд╛рд░': 1, 'рдордВрдЧрд▓рд╡рд╛рд░': 1, 'рдмреБрдзрд╡рд╛рд░': 1, 'рдЧреБрд░реБрд╡рд╛рд░': 1, 'рд╢реБрдХреНрд░рд╡рд╛рд░': 1, 'рд╢рдирд┐рд╡рд╛рд░': 1, 'рд░рд╡рд┐рд╡рд╛рд░': 1,
            },
            'mr': {  # Marathi - Common words and phrases, especially those distinct from Hindi
                # High-weight indicators (very common in Marathi)
                'рдЖрд╣реЗ': 5, 'рдЖрд╣реЗрдд': 5, 'рдЖрд╣реЛрдд': 5, 'рдЖрд╣реЗ': 4, 'рдЖрд╣реЗ': 4,
                'рдЖрд╣реЗ': 4, 'рдЖрд╣реЗ': 4, 'рдЖрд╣реЗ': 4, 'рдЖрд╣реЗ': 4,
                'рдЖрд╣реЗ': 4, 'рдЖрд╣реЗ': 4, 'рдЖрд╣реЗ': 4, 'рдЖрд╣реЗ': 4,
                'рдХрд╛рдп': 4, 'рдХреБрдареЗ': 4, 'рдХрдзреА': 4, 'рдХрд╕реЗ': 4, 'рдХрд┐рддреА': 4, 'рдХреЛрдг': 4,
                'рд╣рд╛': 4, 'рд╣реА': 4, 'рд╣реЗ': 4, 'рд╣реЗ': 4,
                'рдореА': 5, 'рдорд╛рдЭрд╛': 4, 'рдорд╛рдЭреА': 4, 'рдорд╛рдЭреЗ': 4, 'рдЖрдореНрд╣реА': 4, 'рдЖрдордЪрд╛': 3, 'рдЖрдордЪреА': 3, 'рдЖрдордЪреЗ': 3,
                'рддреВ': 4, 'рддреБрдЭрд╛': 3, 'рддреБрдЭреА': 3, 'рддреБрдЭреЗ': 3, 'рддреБрдореНрд╣реА': 4, 'рддреБрдордЪрд╛': 3, 'рддреБрдордЪреА': 3, 'рддреБрдордЪреЗ': 3,
                'рддреЛ': 3, 'рддреА': 3, 'рддреЗ': 3, 'рддреНрдпрд╛рдВрдЪрд╛': 3, 'рддреНрдпрд╛рдВрдЪреА': 3, 'рддреНрдпрд╛рдВрдЪреЗ': 3,
                
                # Medium-weight indicators (common in Marathi but less common in Hindi)
                'рд▓рд╛': 3, 'рдиреЗ': 3, 'рдЪ': 3, 'рдкрдг': 3, 'рдЖрдгрд┐': 3, 'рдХрд┐рдВрд╡рд╛': 3, 'рдкрдг': 3,
                'рдирд╛рд╣реА': 3, 'рдирдХреЛ': 3, 'рд╣реЛрдп': 3,
                
                # Marathi-specific indicators (rare or absent in Hindi)
                'рд╡рд░реНрд╖реЗ': 5, 'рд╡рд┐рдЪрд╛рд░рд╛рдВрдЪреЗ': 5, 'рдордЬрдмреВрдд': 4, 'рдкреНрд░реЗрд░рдгрд╛': 4, 'рдмреМрджреНрдзрд┐рдХ': 4, 'рдЖрдзрд╛рд░': 4,
                'рджреАрд░реНрдШрдХрд╛рд▓реАрди': 5, 'рд╡рд┐рд╢реНрд╡рд╛рд╕': 4, 'рдЬрдорд▓рд╛': 4, 'рдирд╛рддрдВ': 4, 'рд╣реЛрдИрд▓': 4, 'рддреБрдЭреНрдпрд╛': 4,
                'рдЬреЛрдбреАрджрд╛рд░рд╛рдХрдбреВрди': 5, 'рдорд┐рд│реЗрд▓': 4, 'рдЕрд╕реЗрд▓': 4, 'рдорддрднреЗрдж': 4, 'рд╕рдВрднрд╡рддрд╛рдд': 4,
                'рдХрд░рддрд╛': 3, 'рдХрд░реВрди': 3, 'рдХрд░рддрд╛рдирд╛': 3, 'рдХрд░рддреЗрд╡реЗрд│реА': 3,
                'рдпреЗрддреЛ': 3, 'рдпреЗрддреЗ': 3, 'рдпреЗрддрд╛рдд': 3, 'рдЧреЗрд▓рд╛': 3, 'рдЧреЗрд▓реА': 3, 'рдЧреЗрд▓реЗ': 3,
                'рдЬрд╛рддреЛ': 3, 'рдЬрд╛рддреЗ': 3, 'рдЬрд╛рддрд╛рдд': 3, 'рдЬрд╛рдК': 3, 'рдЬрд╛рдКрди': 3,
                'рдмрдШрддреЛ': 3, 'рдмрдШрддреЗ': 3, 'рдмрдШрддрд╛рдд': 3, 'рдмрдШреВ': 3, 'рдмрдШреВрди': 3,
                'рдмреЛрд▓рддреЛ': 3, 'рдмреЛрд▓рддреЗ': 3, 'рдмреЛрд▓рддрд╛рдд': 3, 'рдмреЛрд▓реВ': 3, 'рдмреЛрд▓реВрди': 3,
                'рд╢рдХрддреЛ': 3, 'рд╢рдХрддреЗ': 3, 'рд╢рдХрддрд╛рдд': 3, 'рд╢рдХрддреЛ': 3, 'рд╢рдХрддреЗ': 3, 'рд╢рдХрддрд╛рдд': 3,
                'рд╣рд╡рд╛': 3, 'рд╣рд╡реА': 3, 'рд╣рд╡реЗ': 3, 'рд╣рд╡реЗрд╕реЗ': 3, 'рд╣рд╡рд╛рдпрд▓рд╛': 3,
                'рджреЗрддреЛ': 3, 'рджреЗрддреЗ': 3, 'рджреЗрддрд╛рдд': 3, 'рджреЗрдК': 3, 'рджреЗрдКрди': 3,
                'рдШреЗрддреЛ': 3, 'рдШреЗрддреЗ': 3, 'рдШреЗрддрд╛рдд': 3, 'рдШреЗрдК': 3, 'рдШреЗрдКрди': 3,
                'рдЦрд╛рддреЛ': 3, 'рдЦрд╛рддреЗ': 3, 'рдЦрд╛рддрд╛рдд': 3, 'рдЦрд╛рдК': 3, 'рдЦрд╛рдКрди': 3,
                'рдкрд┐рддреЛ': 3, 'рдкреАрддреЗ': 3, 'рдкреАрддрд╛рдд': 3, 'рдкрд┐рдК': 3, 'рдкрд┐рдКрди': 3,
                'рдЬрд╛рдЧрд╛': 3, 'рдЬрд╛рдЧреА': 3, 'рдЬрд╛рдЧреЗ': 3, 'рдЬрд╛рдЧреЗрд╡рд░': 3, 'рдЬрд╛рдЧреЗрд▓рд╛': 3,
                'рд╡реЗрд│': 3, 'рд╡реЗрд│реА': 3, 'рд╡реЗрд│реЗрд╕': 3, 'рд╡реЗрд│реЗрд▓рд╛': 3,
                'рджрд┐рд╡рд╕': 3, 'рджрд┐рд╡рд╕рд╛рдЪрд╛': 3, 'рджрд┐рд╡рд╕рд╛рд▓рд╛': 3, 'рджрд┐рд╡рд╕рд╛рдд': 3,
                'рд░рд╛рддреНрд░': 3, 'рд░рд╛рддреНрд░реА': 3, 'рд░рд╛рддреНрд░реАрдЪрд╛': 3, 'рд░рд╛рддреНрд░реАрд▓рд╛': 3, 'рд░рд╛рддреНрд░реАрдд': 3,
                'рд╕рдХрд╛рд│': 3, 'рд╕рдХрд╛рд│реА': 3, 'рд╕рдХрд╛рд│реАрдЪрд╛': 3, 'рд╕рдХрд╛рд│реАрд▓рд╛': 3, 'рд╕рдХрд╛рд│реАрдд': 3,
                'рджреБрдкрд╛рд░': 3, 'рджреБрдкрд╛рд░реА': 3, 'рджреБрдкрд╛рд░реАрдЪрд╛': 3, 'рджреБрдкрд╛рд░реАрд▓рд╛': 3, 'рджреБрдкрд╛рд░реАрдд': 3,
                'рд╕рд╛рдпрдВрдХрд╛рд│': 3, 'рд╕рд╛рдпрдВрдХрд╛рд│реА': 3, 'рд╕рд╛рдпрдВрдХрд╛рд│реАрдЪрд╛': 3, 'рд╕рд╛рдпрдВрдХрд╛рд│реАрд▓рд╛': 3, 'рд╕рд╛рдпрдВрдХрд╛рд│реАрдд': 3,
                'рдЖрдЬ': 2, 'рдЙрджреНрдпрд╛': 2, 'рдЙрджреНрдпрд╛рд╣реВрди': 2, 'рдкрд░реНрдпрдВрдд': 2,
                'рдЗрдереЗ': 2, 'рддрд┐рдереЗ': 2, 'рдХреБрдареЗ': 2, 'рдХреБрдареЗрд╣реА': 2, 'рдХреБрдареЗрддрд░реА': 2,
                'рд╕рд░реНрд╡': 2, 'рд╕рд░реНрд╡рд╛рдВрдиреА': 2, 'рд╕рд░реНрд╡рд╛рдВрдЪрд╛': 2, 'рд╕рд░реНрд╡рд╛рдВрдЪреА': 2, 'рд╕рд░реНрд╡рд╛рдВрдЪреЗ': 2,
                'рдХреЛрдгреА': 2, 'рдХрд╛рд╣реА': 2, 'рдХрд╛рд╣реАрд╣реА': 2, 'рдХрд╛рд╣реАрддрд░реА': 2,
                'рдЪрд╛рдВрдЧрд▓рд╛': 2, 'рдЪрд╛рдВрдЧрд▓реА': 2, 'рдЪрд╛рдВрдЧрд▓реЗ': 2, 'рд╡рд╛рдИрдЯ': 2, 'рд╡рд╛рдИрдЯреА': 2, 'рд╡рд╛рдИрдЯреЗ': 2,
                'рдореЛрдард╛': 2, 'рдореЛрдареА': 2, 'рдореЛрдареЗ': 2, 'рд▓рд╣рд╛рди': 2, 'рд▓рд╣рд╛рдиреА': 2, 'рд▓рд╣рд╛рдиреЗ': 2,
                'рдирд╡реАрди': 2, 'рдирд╡реАрдирдЪрд╛': 2, 'рдирд╡реАрдиреА': 2, 'рдирд╡реАрдиреЗ': 2, 'рдЬреБрдирд╛': 2, 'рдЬреБрдиреА': 2, 'рдЬреБрдиреЗ': 2,
                'рдПрдХ': 2, 'рджреЛрди': 2, 'рддреАрди': 2, 'рдЪрд╛рд░': 2, 'рдкрд╛рдЪ': 2,
                'рд╕рд╣рд╛': 2, 'рд╕рд╛рдд': 2, 'рдЖрда': 2, 'рдирдК': 2, 'рджрд╣рд╛': 2,
                'рд╢рдВрднрд░': 2, 'рд╣рдЬрд╛рд░': 2, 'рд▓рд╛рдЦ': 2, 'рдХреЛрдЯреА': 2,
                'рд░рдВрдЧ': 2, 'рд╕реБрдЧрдВрдз': 2, 'рдЪрд╡': 2, 'рдЖрд╡рд╛рдЬ': 2, 'рд░реВрдк': 2,
                'рдШрд░': 2, 'рджрд╛рд░': 2, 'рдЦрд┐рдбрдХреА': 2, 'рдЦреЛрд▓реА': 2, 'рд╕реНрдирд╛рдирдЧреГрд╣': 2,
                'рд╢рд╛рд│рд╛': 2, 'рдорд╣рд╛рд╡рд┐рджреНрдпрд╛рд▓рдп': 2, 'рдХрд╛рд░реНрдпрд╛рд▓рдп': 2, 'рдмрд╛рдЬрд╛рд░': 2, 'рджреБрдХрд╛рди': 2,
                'рдЧрд╛рдбреА': 2, 'рдмрд╕': 2, 'рд░реЗрд▓реНрд╡реЗ': 2, 'рд╡рд┐рдорд╛рди': 2, 'рд╕рд╛рдпрдХрд▓': 2,
                'рдкреИрд╕реЗ': 2, 'рд░реБрдкрдпрд╛': 2, 'рдЕрдХреВрдд': 2, 'рдзрди': 2,
                'рдЬреЗрд╡рдг': 2, 'рдкрд╛рдгреА': 2, 'рджреВрдз': 2, 'рдЪрд╣рд╛': 2, 'рдХреЙрдлреА': 2,
                'рднрд╛рдЬреА': 2, 'рдлрд│реЗ': 2, 'рдорд╛рдВрд╕': 2, 'рддрд╛рдВрджреВрд│': 2, 'рднрд╛рдХрд░реА': 2,
                'рдХреБрдЯреБрдВрдм': 2, 'рдЖрдИ-рд╡рдбреАрд▓': 2, 'рдореБрд▓реЗ': 2, 'рднрд╛рдК': 2, 'рдмрд╣реАрдг': 2,
                'рдорд┐рддреНрд░': 2, 'рд╢реЗрдЬрд╛рд░реА': 2, 'рдкрд░рджреЗрд╢реА': 2, 'рд╢рддреНрд░реВ': 2,
                'рд╢рд╣рд░': 2, 'рдЧрд╛рд╡': 2, 'рджреЗрд╢': 2, 'рдкрд░рджреЗрд╢': 2,
                'рд░рд╕реНрддрд╛': 2, 'рд╡рд│рдг': 2, 'рдУрдврд╛': 2, 'рдирд╛рд▓рд╛': 2, 'рдирджреА': 2,
                'рдбреЛрдВрдЧрд░': 2, 'рдЯреЗрдХрдбреА': 2, 'рдЦрд┐рдВрдбреА': 2, 'рдореИрджрд╛рди': 2, 'рдЬрдВрдЧрд▓': 2,
                'рд╡реЗрд│': 2, 'рджрд┐рд╡рд╕': 2, 'рд░рд╛рддреНрд░': 2, 'рд╕рдХрд╛рд│': 2, 'рджреБрдкрд╛рд░': 2, 'рд╕рд╛рдпрдВрдХрд╛рд│': 2,
                'рдЖрдард╡рдбрд╛': 2, 'рдорд╣рд┐рдирд╛': 2, 'рд╡рд░реНрд╖': 2, 'рд╣рдВрдЧрд╛рдо': 2,
                'рдЬрд╛рдиреЗрд╡рд╛рд░реА': 2, 'рдлреЗрдмреНрд░реБрд╡рд╛рд░реА': 2, 'рдорд╛рд░реНрдЪ': 2, 'рдПрдкреНрд░рд┐рд▓': 2, 'рдореЗ': 2, 'рдЬреВрди': 2,
                'рдЬреБрд▓реИ': 2, 'рдСрдЧрд╕реНрдЯ': 2, 'рд╕рдкреНрдЯреЗрдВрдмрд░': 2, 'рдСрдХреНрдЯреЛрдмрд░': 2, 'рдиреЛрд╡реНрд╣реЗрдВрдмрд░': 2, 'рдбрд┐рд╕реЗрдВрдмрд░': 2,
                'рд╕реЛрдорд╡рд╛рд░': 2, 'рдордВрдЧрд│рд╡рд╛рд░': 2, 'рдмреБрдзрд╡рд╛рд░': 2, 'рдЧреБрд░реБрд╡рд╛рд░': 2, 'рд╢реБрдХреНрд░рд╡рд╛рд░': 2, 'рд╢рдирд┐рд╡рд╛рд░': 2, 'рд░рд╡рд┐рд╡рд╛рд░': 2,
            },
            'gu': {  # Gujarati - Common words and phrases
                # High-weight indicators (very common in Gujarati)
                'ркЫрлЗ': 5, 'ркЫрлБркВ': 5, 'ркЫрлЗ': 5, 'ркЫрлЛ': 5, 'ркЫрлЗ': 5, 'ркЫрлЗ': 5,
                'ркерк╢рлЗ': 4, 'ркерк╢рлЛ': 4, 'ркерк╢рлЗ': 4, 'ркерк╢рлЛ': 4,
                'рк╢рлБркВ': 4, 'ркХрлНркпрк╛ркВ': 4, 'ркХрлНркпрк╛рк░рлЗ': 4, 'ркХрлЗрк╡рлА рк░рлАркдрлЗ': 4, 'ркХрлЗркЯрк▓рлБркВ': 4, 'ркХрлЗркЯрк▓рлА': 4, 'ркХрлЗркЯрк▓рк╛': 4,
                'ркЖ': 4, 'ркЖрк╡рк╛': 3, 'ркЖрк╡рлА': 3, 'ркЖрк╡рк╛': 3,
                'ркдрлЗ': 4, 'ркдрлЗрк╡рк╛': 3, 'ркдрлЗрк╡рлА': 3, 'ркдрлЗрк╡рк╛': 3,
                'рк╣рлБркВ': 5, 'ркорк╛рк░рлБркВ': 4, 'ркорк╛рк░рлА': 4, 'ркорк╛рк░рк╛': 4, 'ркЕркорлЗ': 4, 'ркЕркорк╛рк░рлБркВ': 3, 'ркЕркорк╛рк░рлА': 3, 'ркЕркорк╛рк░рк╛': 3,
                'ркдрлБркВ': 4, 'ркдрк╛рк░рлБркВ': 3, 'ркдрк╛рк░рлА': 3, 'ркдрк╛рк░рк╛': 3, 'ркдркорлЗ': 4, 'ркдркорк╛рк░рлБркВ': 3, 'ркдркорк╛рк░рлА': 3, 'ркдркорк╛рк░рк╛': 3,
                'ркдрлЗркУ': 3, 'ркдрлЗркоркирлБркВ': 3, 'ркдрлЗркоркирлА': 3, 'ркдрлЗркоркирк╛': 3,
                
                # Medium-weight indicators (common in Gujarati)
                'ркирлЗ': 3, 'ркерлА': 3, 'рккрк░': 3, 'ркорк╛ркЯрлЗ': 3, 'ркЕркирлЗ': 3, 'рккркг': 3, 'ркХрлЗ': 3,
                'ркиркерлА': 3, 'ркирк╣рлАркВ': 3, 'рк╣рк╛': 3, 'ркЬркп': 3,
                
                # Gujarati-specific indicators
                'рк╡рк░рлНрк╖рлЛ': 4, 'рк╡рк┐ркЪрк╛рк░рлЛ': 4, 'ркоркЬркмрлВркд': 3, 'рккрлНрк░рлЗрк░ркгрк╛': 3, 'ркмрлМркжрлНркзрк┐ркХ': 3, 'ркЖркзрк╛рк░': 3,
                'рк▓рк╛ркВркмрк╛ркЧрк╛рк│рк╛ркирлБркВ': 4, 'рк╡рк┐рк╢рлНрк╡рк╛рк╕': 3, 'ркеркпрлБркВ': 3, 'рк╕ркВркмркВркз': 3, 'ркерк╢рлЗ': 3, 'ркдрк╛рк░рк╛': 3,
                'рк╕рк╛ркерлЗркерлА': 4, 'ркорк│рк╢рлЗ': 3, 'рк╣рк╢рлЗ': 3, 'ркоркдркнрлЗркж': 3, 'рк╢ркХрлНркп ркЫрлЗ': 3,
                'ркХрк░рк╡рлБркВ': 3, 'ркХрк░рлА': 3, 'ркХрк░рлНркпрк╛': 3, 'ркХрк░ркдрк╛ркВ': 3, 'ркХрк░ркдрк╛ркВ рк╡ркЦркдрлЗ': 3,
                'ркЖрк╡рлЗ ркЫрлЗ': 3, 'ркЖрк╡рлЗ ркЫрлЗ': 3, 'ркЖрк╡рлЗ ркЫрлЗ': 3, 'ркЧркпрлБркВ': 3, 'ркЧркпрлА': 3, 'ркЧркпрк╛': 3,
                'ркЬрк╡рлБркВ': 3, 'ркЬрк╛ркп ркЫрлЗ': 3, 'ркЬрк╛ркп ркЫрлЗ': 3, 'ркЬрк╛ркп ркЫрлЗ': 3, 'ркЬрк╡рк╛': 3, 'ркЬркИркирлЗ': 3,
                'ркЬрлЛрк╡рлБркВ': 3, 'ркЬрлЛркИркП ркЫрлЗ': 3, 'ркЬрлЛркИркП ркЫрлЗ': 3, 'ркЬрлЛркИркП ркЫрлЗ': 3, 'ркЬрлЛрк╡рк╛': 3, 'ркЬрлЛркИркирлЗ': 3,
                'ркмрлЛрк▓рк╡рлБркВ': 3, 'ркмрлЛрк▓рлАркП ркЫрлЗ': 3, 'ркмрлЛрк▓рлАркП ркЫрлЗ': 3, 'ркмрлЛрк▓рлАркП ркЫрлЗ': 3, 'ркмрлЛрк▓рк╡рк╛': 3, 'ркмрлЛрк▓рлАркирлЗ': 3,
                'рк╢ркХрлЗ ркЫрлЗ': 3, 'рк╢ркХрлЗ ркЫрлЗ': 3, 'рк╢ркХрлЗ ркЫрлЗ': 3, 'рк╢ркХрлЗ ркЫрлЗ': 3, 'рк╢ркХрлЗ ркЫрлЗ': 3, 'рк╢ркХрлЗ ркЫрлЗ': 3,
                'ркЬрлЛркИркП': 3, 'ркЬрлЛркИркП': 3, 'ркЬрлЛркИркП': 3, 'ркЬрлЛркИркП ркЫрлЗ': 3, 'ркЬрлЛркИркП ркЫрлЗ': 3, 'ркЬрлЛркИркП ркЫрлЗ': 3,
                'ркЖрккрлБркВ ркЫрлБркВ': 3, 'ркЖрккрлА ркЫрлЗ': 3, 'ркЖрккрлА ркЫрлЗ': 3, 'ркЖрккрк╡рлБркВ': 3, 'ркЖрккрлАркирлЗ': 3,
                'рк▓ркИ ркЫрлБркВ': 3, 'рк▓рлЗ ркЫрлЗ': 3, 'рк▓рлЗ ркЫрлЗ': 3, 'рк▓рлЗрк╡рлБркВ': 3, 'рк▓рлАркирлЗ': 3,
                'ркЦрк╛ркЙркВ ркЫрлБркВ': 3, 'ркЦрк╛ркп ркЫрлЗ': 3, 'ркЦрк╛ркп ркЫрлЗ': 3, 'ркЦрк╛рк╡рлБркВ': 3, 'ркЦрк╛ркИркирлЗ': 3,
                'рккрлАркЙркВ ркЫрлБркВ': 3, 'рккрлАркП ркЫрлЗ': 3, 'рккрлАркП ркЫрлЗ': 3, 'рккрлАрк╡рлБркВ': 3, 'рккрлАркИркирлЗ': 3,
                'ркКркВркШрлА рк░рк╣рлНркпрлЛ ркЫрлБркВ': 3, 'ркКркВркШрлА рк░рк╣рлА ркЫрлЗ': 3, 'ркКркВркШрлА рк░рк╣рлНркпрк╛ ркЫрлЗ': 3, 'рк╕рлВрк╡рлБркВ': 3, 'рк╕рлВркИркирлЗ': 3,
                'ркЬркЧрлНркпрк╛': 3, 'ркЬркЧрлНркпрк╛ркП': 3, 'ркЬркЧрлНркпрк╛ркерлА': 3, 'ркЬркЧрлНркпрк╛ркирлЗ': 3,
                'рк╕ркоркп': 3, 'рк╕ркоркпрлЗ': 3, 'рк╕ркоркпркерлА': 3, 'рк╕ркоркпркирлЗ': 3,
                'ркжрк┐рк╡рк╕': 3, 'ркжрк┐рк╡рк╕ркирлЛ': 3, 'ркжрк┐рк╡рк╕ркирлЗ': 3, 'ркжрк┐рк╡рк╕рлЗ': 3, 'ркжрк┐рк╡рк╕ркорк╛ркВ': 3,
                'рк░рк╛ркд': 3, 'рк░рк╛ркдрлНрк░рлА': 3, 'рк░рк╛ркдрлНрк░рлАркирлЛ': 3, 'рк░рк╛ркдрлНрк░рлАркирлЗ': 3, 'рк░рк╛ркдрлНрк░рлАркП': 3, 'рк░рк╛ркдрлНрк░рлАркорк╛ркВ': 3,
                'рк╕рк╡рк╛рк░': 3, 'рк╕рк╡рк╛рк░рлЗ': 3, 'рк╕рк╡рк╛рк░ркерлА': 3, 'рк╕рк╡рк╛рк░ркирлЗ': 3, 'рк╕рк╡рк╛рк░рлЗ': 3, 'рк╕рк╡рк╛рк░ркорк╛ркВ': 3,
                'ркмрккрлЛрк░': 3, 'ркмрккрлЛрк░рлЗ': 3, 'ркмрккрлЛрк░ркерлА': 3, 'ркмрккрлЛрк░ркирлЗ': 3, 'ркмрккрлЛрк░рлЗ': 3, 'ркмрккрлЛрк░ркорк╛ркВ': 3,
                'рк╕рк╛ркВркЬ': 3, 'рк╕рк╛ркВркЬрлЗ': 3, 'рк╕рк╛ркВркЬркерлА': 3, 'рк╕рк╛ркВркЬркирлЗ': 3, 'рк╕рк╛ркВркЬрлЗ': 3, 'рк╕рк╛ркВркЬркорк╛ркВ': 3,
                'ркЖркЬрлЗ': 2, 'ркХрк╛рк▓рлЗ': 2, 'ркЖрк╡ркдрлАркХрк╛рк▓рлЗ': 2, 'рк╕рлБркзрлА': 2,
                'ркЕрк╣рлАркВ': 2, 'ркдрлНркпрк╛ркВ': 2, 'ркХрлНркпрк╛ркВ': 2, 'ркХрлНркпрк╛ркВ рккркг': 2, 'ркХрлНркпрк╛ркВ ркдрк░рлАркХрлЗ': 2,
                'ркмркзрк╛': 2, 'ркмркзрк╛ ркорк╛ркЯрлЗ': 2, 'ркмркзрк╛ркирлЛ': 2, 'ркмркзрк╛ркирлА': 2, 'ркмркзрк╛ркирк╛': 2,
                'ркХрлЛркг': 2, 'ркХркВркИркХ': 2, 'ркХркВркИркХ рккркг': 2, 'ркХркВркИркХ ркдрк░рлАркХрлЗ': 2,
                'рк╕рк╛рк░рлБркВ': 2, 'рк╕рк╛рк░рлА': 2, 'рк╕рк╛рк░рк╛': 2, 'ркЦрк░рк╛ркм': 2, 'ркЦрк░рк╛ркмрлА': 2, 'ркЦрк░рк╛ркмрк╛': 2,
                'ркорлЛркЯрлБркВ': 2, 'ркорлЛркЯрлА': 2, 'ркорлЛркЯрк╛': 2, 'ркирк╛ркирлБркВ': 2, 'ркирк╛ркирлА': 2, 'ркирк╛ркирк╛': 2,
                'ркирк╡рлБркВ': 2, 'ркирк╡рлА': 2, 'ркирк╡рк╛': 2, 'ркЬрлВркирлБркВ': 2, 'ркЬрлВркирлА': 2, 'ркЬрлВркирк╛': 2,
                'ркПркХ': 2, 'ркмрлЗ': 2, 'ркдрлНрк░ркг': 2, 'ркЪрк╛рк░': 2, 'рккрк╛ркВркЪ': 2,
                'ркЫ': 2, 'рк╕рк╛ркд': 2, 'ркЖрка': 2, 'ркирк╡': 2, 'ркжрк╕': 2,
                'рк╕рлЛ': 2, 'рк╣ркЬрк╛рк░': 2, 'рк▓рк╛ркЦ': 2, 'ркХрк░рлЛркб': 2,
                'рк░ркВркЧ': 2, 'рк╕рлБркЧркВркз': 2, 'рк╕рлНрк╡рк╛ркж': 2, 'ркЕрк╡рк╛ркЬ': 2, 'ркжрлЗркЦрк╛рк╡': 2,
                'ркШрк░': 2, 'ркжрк░рк╡рк╛ркЬрлЛ': 2, 'ркмрк╛рк░рлАркЦрлЛрк▓рлЛ': 2, 'рк░рлВрко': 2, 'рк╕рлНркирк╛ркиркЦркВркб': 2,
                'рк╢рк╛рк│рк╛': 2, 'ркХрлЙрк▓рлЗркЬ': 2, 'ркУрклрк┐рк╕': 2, 'ркмркЬрк╛рк░': 2, 'ркжрлБркХрк╛рки': 2,
                'ркЧрк╛ркбрлА': 2, 'ркмрк╕': 2, 'ркЯрлНрк░рлЗрки': 2, 'рк╡рк┐ркорк╛рки': 2, 'рк╕рк╛ркпркХрк▓': 2,
                'рккрлИрк╕рк╛': 2, 'рк░рлВрккрк┐ркпрк╛': 2, 'ркЕркврк│ркХ': 2, 'ркзркирк╡рк╛рки': 2,
                'ркЦрк╛рк╡рк╛ркирлБркВ': 2, 'рккрк╛ркгрлА': 2, 'ркжрлВркз': 2, 'ркЪрк╛': 2, 'ркХрлЙрклрлА': 2,
                'рк╢рк╛ркХркнрк╛ркЬрлА': 2, 'рклрк│рлЛ': 2, 'ркорк╛ркВрк╕': 2, 'ркЪрлЛркЦрк╛': 2, 'рк░рлЛркЯрк▓рлА': 2,
                'рккрк░рк┐рк╡рк╛рк░': 2, 'ркорк╛ркдрк╛-рккрк┐ркдрк╛': 2, 'ркмрк╛рк│ркХрлЛ': 2, 'ркнрк╛ркИ': 2, 'ркмрк╣рлЗрки': 2,
                'ркорк┐ркдрлНрк░': 2, 'рккркбрлЛрк╢рлА': 2, 'ркЕркЬрк╛ркгрлНркпрк╛': 2, 'ркжрлБрк╢рлНркорки': 2,
                'рк╢рк╣рлЗрк░': 2, 'ркЧрк╛рко': 2, 'ркжрлЗрк╢': 2, 'рк╡рк┐ркжрлЗрк╢': 2,
                'рк░рк╕рлНркдрлЛ': 2, 'рк╡рк╛рк│рлБркВ': 2, 'рк╡рк│рк╛ркВркХ': 2, 'ркирк╛рк│рлЛ': 2, 'ркиркжрлА': 2,
                'рккрк░рлНрк╡ркд': 2, 'ркЯрлЗркХрк░рлА': 2, 'ркЦрлАркг': 2, 'ркорлЗркжрк╛рки': 2, 'ркЬркВркЧрк▓': 2,
                'рк╕ркоркп': 2, 'ркжрк┐рк╡рк╕': 2, 'рк░рк╛ркд': 2, 'рк╕рк╡рк╛рк░': 2, 'ркмрккрлЛрк░': 2, 'рк╕рк╛ркВркЬ': 2,
                'ркЕркарк╡рк╛ркбрк┐ркпрлБркВ': 2, 'ркорк╣рк┐ркирлЛ': 2, 'рк╡рк░рлНрк╖': 2, 'ркЛркдрлБ': 2,
                'ркЬрк╛ркирлНркпрлБркЖрк░рлА': 2, 'рклрлЗркмрлНрк░рлБркЖрк░рлА': 2, 'ркорк╛рк░рлНркЪ': 2, 'ркПрккрлНрк░рк┐рк▓': 2, 'ркорлЗ': 2, 'ркЬрлВрки': 2,
                'ркЬрлБрк▓рк╛ркИ': 2, 'ркСркЧрк╕рлНркЯ': 2, 'рк╕рккрлНркЯрлЗркорлНркмрк░': 2, 'ркСркХрлНркЯрлЛркмрк░': 2, 'ркирк╡рлЗркорлНркмрк░': 2, 'ркбрк┐рк╕рлЗркорлНркмрк░': 2,
                'рк╕рлЛркорк╡рк╛рк░': 2, 'ркоркВркЧрк│рк╡рк╛рк░': 2, 'ркмрлБркзрк╡рк╛рк░': 2, 'ркЧрлБрк░рлБрк╡рк╛рк░': 2, 'рк╢рлБркХрлНрк░рк╡рк╛рк░': 2, 'рк╢ркирк┐рк╡рк╛рк░': 2, 'рк░рк╡рк┐рк╡рк╛рк░': 2,
            },
            'ne': {  # Nepali - Common words and phrases, especially those distinct from Hindi
                # High-weight indicators (very common in Nepali)
                'рдЫ': 5, 'рдЫреБ': 5, 'рдЫреМ': 5, 'рдЫрдиреН': 5, 'рдЫрд┐рдиреН': 5, 'рдЫреМрдБ': 5,
                'рдЫреБрдБ': 5, 'рдЫреМрдБ': 5, 'рдЫрд┐рдиреН': 5, 'рдЫреМрдБ': 5,
                'рд╣реЛ': 4, 'рд╣реБрдиреН': 4, 'рд╣реБрдиреЗрдЫ': 4, 'рд╣реБрдиреНрдЫ': 4, 'рд╣реБрдиреНрдереНрдпреЛ': 4, 'рд╣реБрдиреНрдерд┐рдпреЛ': 4,
                'рдХреЗ': 4, 'рдХреБрди': 4, 'рдХрддрд┐': 4, 'рдХрд╣рд┐рд▓реЗ': 4, 'рдХрд╕рд░реА': 4, 'рдХрд╣рд╛рдБ': 4, 'рдХрддреИ': 4,
                'рдпреЛ': 4, 'рдпреА': 4, 'рдпрд┐рдиреА': 4, 'рдпрд┐рдирдХреЛ': 4,
                'рддреНрдпреЛ': 4, 'рддреА': 4, 'рддрд┐рдиреА': 4, 'рддрд┐рдирдХреЛ': 4,
                'рдо': 5, 'рдореЗрд░реЛ': 4, 'рдореИрд▓реЗ': 4, 'рдореЗрд░реИ': 4, 'рд╣рд╛рдореА': 4, 'рд╣рд╛рдореНрд░реЛ': 3, 'рд╣рд╛рдореАрд▓реЗ': 3,
                'рддрд┐рдореА': 5, 'рддрд┐рдореНрд░реЛ': 4, 'рддрд┐рдореАрд▓реЗ': 4, 'рддрдкрд╛рдИрдВ': 4, 'рддрдкрд╛рдИрдВрдХреЛ': 3, 'рддрдкрд╛рдИрдВрд▓реЗ': 3,
                'рдЙрдиреА': 4, 'рдЙрдирдХреЛ': 3, 'рдЙрдирд▓реЗ': 3, 'рдЙрдиреАрд╣рд░реВ': 3, 'рдЙрдиреАрд╣рд░реВрдХреЛ': 3, 'рдЙрдиреАрд╣рд░реВрд▓реЗ': 3,
                
                # Medium-weight indicators (common in Nepali but less common in Hindi)
                'рд▓рд╛рдИ': 3, 'рдмрд╛рдЯ': 3, 'рд░': 3, 'рдХреЛ': 3, 'рд▓реЗ': 3, 'рдорд╛': 3, 'рджреЗрдЦрд┐': 3, 'рд╕рдореНрдо': 3,
                'рдЧрд░реНрдиреБ': 3, 'рдЧрд░реНрдиреЗ': 3, 'рдЧрд░реЗрдХреЛ': 3, 'рдЧрд░рд┐рдПрдХреЛ': 3, 'рдЧрд░реНрдиреБрдкрд░реНрдиреЗ': 3,
                'рдЧрд░реНрдиреБрд╣реБрдиреНрдЫ': 3, 'рдЧрд░реНрдиреБрд╣реБрдиреНрдЫ': 3, 'рдЧрд░реНрдиреБрд╣реБрдиреНрдЫ': 3,
                'рднрдПрдХреЛ': 3, 'рднрдПрдХреА': 3, 'рднрдПрдХрд╛': 3, 'рднрдПрдХреЛ рдерд┐рдпреЛ': 3, 'рднрдПрдХреА рдерд┐рдЗрдиреН': 3, 'рднрдПрдХрд╛ рдерд┐рдП': 3,
                'рдЧрдПрдХреЛ': 3, 'рдЧрдПрдХреА': 3, 'рдЧрдПрдХрд╛': 3, 'рдЧрдПрдХреЛ рдерд┐рдпреЛ': 3, 'рдЧрдПрдХреА рдерд┐рдЗрдиреН': 3, 'рдЧрдПрдХрд╛ рдерд┐рдП': 3,
                'рдЖрдПрдХреЛ': 3, 'рдЖрдПрдХреА': 3, 'рдЖрдПрдХрд╛': 3, 'рдЖрдПрдХреЛ рдерд┐рдпреЛ': 3, 'рдЖрдПрдХреА рдерд┐рдЗрдиреН': 3, 'рдЖрдПрдХрд╛ рдерд┐рдП': 3,
                'рд╣реБрдиреНрдЫ': 3, 'рд╣реБрдиреНрдЫрдиреН': 3, 'рд╣реБрдиреНрдЫрд┐рдиреН': 3, 'рд╣реБрдиреНрдереНрдпреЛ': 3, 'рд╣реБрдиреНрдереЗ': 3, 'рд╣реБрдиреНрдерд┐рдиреН': 3,
                'рдмрд╕реНрдиреБ': 3, 'рдмрд╕реНрдиреЗ': 3, 'рдмрд╕реЗрдХреЛ': 3, 'рдмрд╕рд┐рдПрдХреЛ': 3, 'рдмрд╕реНрдиреБрдкрд░реНрдиреЗ': 3,
                'рдмрд╕реНрдиреБрд╣реБрдиреНрдЫ': 3, 'рдмрд╕реНрдиреБрд╣реБрдиреНрдЫ': 3, 'рдмрд╕реНрдиреБрд╣реБрдиреНрдЫ': 3,
                'рдЬрд╛рдиреБ': 3, 'рдЬрд╛рдиреЗ': 3, 'рдЧрдПрдХреЛ': 3, 'рдЧрдПрдХреЛ': 3, 'рдЬрд╛рдиреБрдкрд░реНрдиреЗ': 3,
                'рдЬрд╛рдиреБрд╣реБрдиреНрдЫ': 3, 'рдЬрд╛рдиреБрд╣реБрдиреНрдЫ': 3, 'рдЬрд╛рдиреБрд╣реБрдиреНрдЫ': 3,
                'рдЖрдЙрдиреБ': 3, 'рдЖрдЙрдиреЗ': 3, 'рдЖрдПрдХреЛ': 3, 'рдЖрдПрдХреЛ': 3, 'рдЖрдЙрдиреБрдкрд░реНрдиреЗ': 3,
                'рдЖрдЙрдиреБрд╣реБрдиреНрдЫ': 3, 'рдЖрдЙрдиреБрд╣реБрдиреНрдЫ': 3, 'рдЖрдЙрдиреБрд╣реБрдиреНрдЫ': 3,
                'рджреЗрдЦреНрдиреБ': 3, 'рджреЗрдЦреНрдиреЗ': 3, 'рджреЗрдЦреЗрдХреЛ': 3, 'рджреЗрдЦрд┐рдПрдХреЛ': 3, 'рджреЗрдЦреНрдиреБрдкрд░реНрдиреЗ': 3,
                'рджреЗрдЦреНрдиреБрд╣реБрдиреНрдЫ': 3, 'рджреЗрдЦреНрдиреБрд╣реБрдиреНрдЫ': 3, 'рджреЗрдЦреНрдиреБрд╣реБрдиреНрдЫ': 3,
                'рд╕реБрдиреНрдиреБ': 3, 'рд╕реБрдиреНрдиреЗ': 3, 'рд╕реБрдиреЗрдХреЛ': 3, 'рд╕реБрдирд┐рдПрдХреЛ': 3, 'рд╕реБрдиреНрдиреБрдкрд░реНрдиреЗ': 3,
                'рд╕реБрдиреНрдиреБрд╣реБрдиреНрдЫ': 3, 'рд╕реБрдиреНрдиреБрд╣реБрдиреНрдЫ': 3, 'рд╕реБрдиреНрдиреБрд╣реБрдиреНрдЫ': 3,
                'рдЦрд╛рдиреБ': 3, 'рдЦрд╛рдиреЗ': 3, 'рдЦрд╛рдПрдХреЛ': 3, 'рдЦрд╛рдЗрдПрдХреЛ': 3, 'рдЦрд╛рдиреБрдкрд░реНрдиреЗ': 3,
                'рдЦрд╛рдиреБрд╣реБрдиреНрдЫ': 3, 'рдЦрд╛рдиреБрд╣реБрдиреНрдЫ': 3, 'рдЦрд╛рдиреБрд╣реБрдиреНрдЫ': 3,
                'рдкрд┐рдЙрдиреБ': 3, 'рдкрд┐рдЙрдиреЗ': 3, 'рдкрд┐рдПрдХреЛ': 3, 'рдкрд┐рдЗрдПрдХреЛ': 3, 'рдкрд┐рдЙрдиреБрдкрд░реНрдиреЗ': 3,
                'рдкрд┐рдЙрдиреБрд╣реБрдиреНрдЫ': 3, 'рдкрд┐рдЙрдиреБрд╣реБрдиреНрдЫ': 3, 'рдкрд┐рдЙрдиреБрд╣реБрдиреНрдЫ': 3,
                'рдЧрд░реНрди': 2, 'рдЧрд░реНрдиреЗ': 2, 'рдЧрд░реНрджреИ': 2, 'рдЧрд░реНрдиреБрд╣реЛрд╕реН': 2, 'рдЧрд░реМрдВ': 2, 'рдЧрд░реМрдБ': 2, 'рдЧрд░реМрдБ': 2,
                'рдмрд╕реНрди': 2, 'рдмрд╕реНрдиреЗ': 2, 'рдмрд╕реНрджреИ': 2, 'рдмрд╕реНрдиреБрд╣реЛрд╕реН': 2, 'рдмрд╕реМрдВ': 2, 'рдмрд╕реМрдБ': 2, 'рдмрд╕реМрдБ': 2,
                'рдЬрд╛рди': 2, 'рдЬрд╛рдиреЗ': 2, 'рдЬрд╛рдБрджреИ': 2, 'рдЬрд╛рдиреБрд╣реЛрд╕реН': 2, 'рдЬрд╛рдФрдВ': 2, 'рдЬрд╛рдФрдБ': 2, 'рдЬрд╛рдФрдБ': 2,
                'рдЖрдЙрди': 2, 'рдЖрдЙрдиреЗ': 2, 'рдЖрдЙрдБрджреИ': 2, 'рдЖрдЙрдиреБрд╣реЛрд╕реН': 2, 'рдЖрдФрдВ': 2, 'рдЖрдФрдБ': 2, 'рдЖрдФрдБ': 2,
                'рджреЗрдЦреНрди': 2, 'рджреЗрдЦреНрдиреЗ': 2, 'рджреЗрдЦреНрджреИ': 2, 'рджреЗрдЦреНрдиреБрд╣реЛрд╕реН': 2, 'рджреЗрдЦреМрдВ': 2, 'рджреЗрдЦреМрдБ': 2, 'рджреЗрдЦреМрдБ': 2,
                'рд╕реБрдиреНрди': 2, 'рд╕реБрдиреНрдиреЗ': 2, 'рд╕реБрдиреНрджреИ': 2, 'рд╕реБрдиреНрдиреБрд╣реЛрд╕реН': 2, 'рд╕реБрдиреМрдВ': 2, 'рд╕реБрдиреМрдБ': 2, 'рд╕реБрдиреМрдБ': 2,
                'рдЦрд╛рди': 2, 'рдЦрд╛рдиреЗ': 2, 'рдЦрд╛рдБрджреИ': 2, 'рдЦрд╛рдиреБрд╣реЛрд╕реН': 2, 'рдЦрд╛рдФрдВ': 2, 'рдЦрд╛рдФрдБ': 2, 'рдЦрд╛рдФрдБ': 2,
                'рдкрд┐рдЙрди': 2, 'рдкрд┐рдЙрдиреЗ': 2, 'рдкрд┐рдЙрдБрджреИ': 2, 'рдкрд┐рдЙрдиреБрд╣реЛрд╕реН': 2, 'рдкрд┐рдФрдВ': 2, 'рдкрд┐рдФрдБ': 2, 'рдкрд┐рдФрдБ': 2,
                
                # Nepali-specific indicators (rare or absent in Hindi)
                'рддреНрдпрд╕реНрддреИ': 4, 'рдпрд╕реНрддреЛ': 4, 'рдпрд╕рд░реА': 3, 'рддреНрдпрд╕рд░реА': 3, 'рдпрд╣рд╛рдБ': 3, 'рддреНрдпрд╣рд╛рдБ': 3,
                'рдХреБрд░рд╛': 4, 'рдЧрд░реНрдиреЗ': 3, 'рдЧрд░реНрдиреБрд╣реБрдиреНрдЫ': 3, 'рдЧрд░реНрдиреБрдкрд░реНрдЫ': 3,
                'рднрдПрдХреЛ': 3, 'рднрдПрдХреА': 3, 'рднрдПрдХрд╛': 3, 'рднрдПрдХреЛ рдерд┐рдпреЛ': 3, 'рднрдПрдХреА рдерд┐рдЗрдиреН': 3, 'рднрдПрдХрд╛ рдерд┐рдП': 3,
                'рдЧрдПрдХреЛ': 3, 'рдЧрдПрдХреА': 3, 'рдЧрдПрдХрд╛': 3, 'рдЧрдПрдХреЛ рдерд┐рдпреЛ': 3, 'рдЧрдПрдХреА рдерд┐рдЗрдиреН': 3, 'рдЧрдПрдХрд╛ рдерд┐рдП': 3,
                'рдЖрдПрдХреЛ': 3, 'рдЖрдПрдХреА': 3, 'рдЖрдПрдХрд╛': 3, 'рдЖрдПрдХреЛ рдерд┐рдпреЛ': 3, 'рдЖрдПрдХреА рдерд┐рдЗрдиреН': 3, 'рдЖрдПрдХрд╛ рдерд┐рдП': 3,
                'рд╣реБрдиреНрдЫ': 3, 'рд╣реБрдиреНрдЫрдиреН': 3, 'рд╣реБрдиреНрдЫрд┐рдиреН': 3, 'рд╣реБрдиреНрдереНрдпреЛ': 3, 'рд╣реБрдиреНрдереЗ': 3, 'рд╣реБрдиреНрдерд┐рдиреН': 3,
                'рдмрд╕реНрдиреБ': 3, 'рдмрд╕реНрдиреЗ': 3, 'рдмрд╕реЗрдХреЛ': 3, 'рдмрд╕рд┐рдПрдХреЛ': 3, 'рдмрд╕реНрдиреБрдкрд░реНрдиреЗ': 3,
                'рдмрд╕реНрдиреБрд╣реБрдиреНрдЫ': 3, 'рдмрд╕реНрдиреБрд╣реБрдиреНрдЫ': 3, 'рдмрд╕реНрдиреБрд╣реБрдиреНрдЫ': 3,
                'рдЬрд╛рдиреБ': 3, 'рдЬрд╛рдиреЗ': 3, 'рдЧрдПрдХреЛ': 3, 'рдЧрдПрдХреЛ': 3, 'рдЬрд╛рдиреБрдкрд░реНрдиреЗ': 3,
                'рдЬрд╛рдиреБрд╣реБрдиреНрдЫ': 3, 'рдЬрд╛рдиреБрд╣реБрдиреНрдЫ': 3, 'рдЬрд╛рдиреБрд╣реБрдиреНрдЫ': 3,
                'рдЖрдЙрдиреБ': 3, 'рдЖрдЙрдиреЗ': 3, 'рдЖрдПрдХреЛ': 3, 'рдЖрдПрдХреЛ': 3, 'рдЖрдЙрдиреБрдкрд░реНрдиреЗ': 3,
                'рдЖрдЙрдиреБрд╣реБрдиреНрдЫ': 3, 'рдЖрдЙрдиреБрд╣реБрдиреНрдЫ': 3, 'рдЖрдЙрдиреБрд╣реБрдиреНрдЫ': 3,
                'рджреЗрдЦреНрдиреБ': 3, 'рджреЗрдЦреНрдиреЗ': 3, 'рджреЗрдЦреЗрдХреЛ': 3, 'рджреЗрдЦрд┐рдПрдХреЛ': 3, 'рджреЗрдЦреНрдиреБрдкрд░реНрдиреЗ': 3,
                'рджреЗрдЦреНрдиреБрд╣реБрдиреНрдЫ': 3, 'рджреЗрдЦреНрдиреБрд╣реБрдиреНрдЫ': 3, 'рджреЗрдЦреНрдиреБрд╣реБрдиреНрдЫ': 3,
                'рд╕реБрдиреНрдиреБ': 3, 'рд╕реБрдиреНрдиреЗ': 3, 'рд╕реБрдиреЗрдХреЛ': 3, 'рд╕реБрдирд┐рдПрдХреЛ': 3, 'рд╕реБрдиреНрдиреБрдкрд░реНрдиреЗ': 3,
                'рд╕реБрдиреНрдиреБрд╣реБрдиреНрдЫ': 3, 'рд╕реБрдиреНрдиреБрд╣реБрдиреНрдЫ': 3, 'рд╕реБрдиреНрдиреБрд╣реБрдиреНрдЫ': 3,
                'рдЦрд╛рдиреБ': 3, 'рдЦрд╛рдиреЗ': 3, 'рдЦрд╛рдПрдХреЛ': 3, 'рдЦрд╛рдЗрдПрдХреЛ': 3, 'рдЦрд╛рдиреБрдкрд░реНрдиреЗ': 3,
                'рдЦрд╛рдиреБрд╣реБрдиреНрдЫ': 3, 'рдЦрд╛рдиреБрд╣реБрдиреНрдЫ': 3, 'рдЦрд╛рдиреБрд╣реБрдиреНрдЫ': 3,
                'рдкрд┐рдЙрдиреБ': 3, 'рдкрд┐рдЙрдиреЗ': 3, 'рдкрд┐рдПрдХреЛ': 3, 'рдкрд┐рдЗрдПрдХреЛ': 3, 'рдкрд┐рдЙрдиреБрдкрд░реНрдиреЗ': 3,
                'рдкрд┐рдЙрдиреБрд╣реБрдиреНрдЫ': 3, 'рдкрд┐рдЙрдиреБрд╣реБрдиреНрдЫ': 3, 'рдкрд┐рдЙрдиреБрд╣реБрдиреНрдЫ': 3,
                'рдЖрдЬ': 2, 'рднреЛрд▓рд┐': 2, 'рдкрд░реНрд╕рд┐': 2, 'рд╕рдореНрдо': 2,
                'рдпрд╣рд╛рдБ': 2, 'рддреНрдпрд╣рд╛рдБ': 2, 'рдХрддреИ': 2, 'рдХрддреИ рдкрдирд┐': 2, 'рдХрддреИ рддрд░': 2,
                'рд╕рдмреИ': 2, 'рд╕рдмреИрд▓реЗ': 2, 'рд╕рдмреИрдХреЛ': 2, 'рд╕рдмреИрд▓рд╛рдИ': 2, 'рд╕рдмреИрд▓реЗ': 2,
                'рдХреЛрд╣реА': 2, 'рдХреЗрд╣реА': 2, 'рдХреЗрд╣реА рдкрдирд┐': 2, 'рдХреЗрд╣реА рддрд░': 2,
                'рд░рд╛рдореНрд░реЛ': 2, 'рд░рд╛рдореНрд░реА': 2, 'рд░рд╛рдореНрд░рд╛': 2, 'рдирд░рд╛рдореНрд░реЛ': 2, 'рдирд░рд╛рдореНрд░реА': 2, 'рдирд░рд╛рдореНрд░рд╛': 2,
                'рдареВрд▓реЛ': 2, 'рдареВрд▓реА': 2, 'рдареВрд▓рд╛': 2, 'рд╕рд╛рдиреЛ': 2, 'рд╕рд╛рдиреА': 2, 'рд╕рд╛рдирд╛': 2,
                'рдирдпрд╛рдБ': 2, 'рдирдпрд╛рдБрдХреЛ': 2, 'рдирдпрд╛рдБрд▓реЗ': 2, 'рдирдпрд╛рдБрд▓рд╛рдИ': 2, 'рдкреБрд░рд╛рдиреЛ': 2, 'рдкреБрд░рд╛рдиреА': 2, 'рдкреБрд░рд╛рдирд╛': 2,
                'рдПрдХ': 2, 'рджреБрдИ': 2, 'рддреАрди': 2, 'рдЪрд╛рд░': 2, 'рдкрд╛рдБрдЪ': 2,
                'рдЫ': 2, 'рд╕рд╛рдд': 2, 'рдЖрда': 2, 'рдиреМ': 2, 'рджрд╢': 2,
                'рд╕рдп': 2, 'рд╣рдЬрд╛рд░': 2, 'рд▓рд╛рдЦ': 2, 'рдХрд░реЛрдб': 2,
                'рд░рдВрдЧ': 2, 'рд╕реБрдЧрдиреНрдз': 2, 'рд╕реНрд╡рд╛рдж': 2, 'рдЖрд╡рд╛рдЬ': 2, 'рджреЗрдЦрд╛рд╡рдЯ': 2,
                'рдШрд░': 2, 'рдвреЛрдХрд╛': 2, 'рдЭреНрдпрд╛рд▓': 2, 'рдХреЛрдард╛': 2, 'рд╕реНрдирд╛рдирдХреЛрдард╛': 2,
                'рд╡рд┐рджреНрдпрд╛рд▓рдп': 2, 'рдХрд▓реЗрдЬ': 2, 'рдХрд╛рд░реНрдпрд╛рд▓рдп': 2, 'рдмрдЬрд╛рд░': 2, 'рдкрд╕рд▓': 2,
                'рдЧрд╛рдбреА': 2, 'рдмрд╕': 2, 'рдЯреНрд░реЗрди': 2, 'рд╡рд┐рдорд╛рди': 2, 'рд╕рд╛рдЗрдХрд▓': 2,
                'рдкреИрд╕рд╛': 2, 'рд░реБрдкреИрдпрд╛рдБ': 2, 'рдЕрдкрд╛рдЩреНрдЧ': 2, 'рдзрдирд╡рд╛рди': 2,
                'рдЦрд╛рдирд╛': 2, 'рдкрд╛рдиреА': 2, 'рджреВрдз': 2, 'я┐╜рд┐рдпрд╛': 2, 'рдХрдлреА': 2,
                'рддрд░рдХрд╛рд░реА': 2, 'рдлрд▓рдлреВрд▓': 2, 'рдорд╛рд╕реБ': 2, 'рдЪрд╛рдорд▓': 2, 'рд░реЛрдЯреА': 2,
                'рдкрд░рд┐рд╡рд╛рд░': 2, 'рдЖрдорд╛-рдмреБрдмрд╛': 2, 'рдмрдЪреНрдЪрд╛': 2, 'рджрд╛рдЬреБрднрд╛рдЗ': 2, 'рджрд┐рджреАрдмрд╣рд┐рдиреА': 2,
                'рд╕рд╛рдереА': 2, 'рдЫрд┐рдореЗрдХреА': 2, 'рдкрд░рджреЗрд╢реА': 2, 'рд╢рддреНрд░реБ': 2,
                'рд╢рд╣рд░': 2, 'рдЧрд╛рдЙрдБ': 2, 'рджреЗрд╢': 2, 'рд╡рд┐рджреЗрд╢': 2,
                'рдмрд╛рдЯреЛ': 2, 'рдмрд╛рдЯреЛрдорд╛': 2, 'рдмрд╛рдЯреЛрдмрд╛рдЯ': 2, 'рдЦреЛрд▓рд╛': 2, 'рдирджреА': 2,
                'рдкрд╣рд╛рдб': 2, 'рдкрд╣рд╛рдбреА': 2, 'рдЙрдкрддреНрдпрдХрд╛': 2, 'рдлрд╛рдБрдЯ': 2, 'рдЬрдВрдЧрд▓': 2,
                'рд╕рдордп': 2, 'рджрд┐рди': 2, 'рд░рд╛рдд': 2, 'рдмрд┐рд╣рд╛рди': 2, 'рджрд┐рдЙрдБрд╕реЛ': 2, 'рд╕рд╛рдБрдЭ': 2,
                'рд╣рдкреНрддрд╛': 2, 'рдорд╣рд┐рдирд╛': 2, 'рд╡рд░реНрд╖': 2, 'рдЛрддреБ': 2,
                'рдЬрдирд╡рд░реА': 2, 'рдлреЗрдмреНрд░реБрдЕрд░реА': 2, 'рдорд╛рд░реНрдЪ': 2, 'рдЕрдкреНрд░рд┐рд▓': 2, 'рдореЗ': 2, 'рдЬреБрди': 2,
                'рдЬреБрд▓рд╛рдИ': 2, 'рдЕрдЧрд╕реНрдЯ': 2, 'рд╕реЗрдкреНрдЯреЗрдореНрдмрд░': 2, 'рдЕрдХреНрдЯреЛрдмрд░': 2, 'рдиреЛрднреЗрдореНрдмрд░': 2, 'рдбрд┐рд╕реЗрдореНрдмрд░': 2,
                'рд╕реЛрдордмрд╛рд░': 2, 'рдордВрдЧрд▓рдмрд╛рд░': 2, 'рдмреБрдзрдмрд╛рд░': 2, 'рдмрд┐рд╣рд┐рдмрд╛рд░': 2, 'рд╢реБрдХреНрд░рдмрд╛рд░': 2, 'рд╢рдирд┐рдмрд╛рд░': 2, 'рдЖрдЗрддрдмрд╛рд░': 2,
            }
        }
        
        # Map to IndicTrans2 language codes
        self.lang_code_map = {
            'hi': 'hin_Deva', 'mr': 'mar_Deva', 'bn': 'ben_Beng', 'ta': 'tam_Taml',
            'te': 'tel_Telu', 'gu': 'guj_Gujr', 'kn': 'kan_Knda', 'ml': 'mal_Mlym',
            'pa': 'pan_Guru', 'or': 'ory_Orya', 'as': 'asm_Beng', 'ur': 'urd_Arab',
            'en': 'eng_Latn', 'ne': 'nep_Deva', 'si': 'sin_Sinh', 'sa': 'san_Deva',
        }
        
        # Confidence thresholds
        self.confidence_thresholds = {
            'high': 5,
            'medium': 3,
            'low': 1
        }

    def is_devanagari_script(self, text):
        """Check if text uses Devanagari script"""
        return any('\u0900' <= char <= '\u097F' for char in text)
    
    def count_devanagari_words(self, text):
        """Count the number of words containing Devanagari characters"""
        return sum(1 for word in text.split() if self.is_devanagari_script(word))
    
    def get_script_ratio(self, text):
        """Get the ratio of Devanagari characters to total characters"""
        if not text:
            return 0
        devanagari_count = sum(1 for char in text if '\u0900' <= char <= '\u097F')
        return devanagari_count / len(text)
    
    def detect_devanagari_language(self, text):
        """
        Enhanced custom detection for Devanagari script languages
        Returns: (language, confidence, method, details)
        """
        lang_scores = {}
        matched_indicators = {}
        
        for lang, indicators in self.devanagari_indicators.items():
            score = 0
            matched = []
            for word, weight in indicators.items():
                if word in text:
                    score += weight
                    matched.append(word)
            if score > 0:
                lang_scores[lang] = score
                matched_indicators[lang] = matched
        
        if lang_scores:
            # Get the language with highest score
            best_lang = max(lang_scores.items(), key=lambda x: x[1])[0]
            confidence = lang_scores[best_lang]
            
            # Determine confidence level
            if confidence >= self.confidence_thresholds['high']:
                conf_level = 'high'
            elif confidence >= self.confidence_thresholds['medium']:
                conf_level = 'medium'
            else:
                conf_level = 'low'
            
            # Special handling for Marathi vs Nepali confusion
            if best_lang == 'ne' and confidence < self.confidence_thresholds['high']:
                # Check for Marathi indicators that might have been missed
                marathi_specific = ['рд╡рд░реНрд╖реЗ', 'рд╡рд┐рдЪрд╛рд░рд╛рдВрдЪреЗ', 'рдордЬрдмреВрдд', 'рдкреНрд░реЗрд░рдгрд╛', 'рдмреМрджреНрдзрд┐рдХ', 'рдЖрдзрд╛рд░', 
                                'рджреАрд░реНрдШрдХрд╛рд▓реАрди', 'рд╡рд┐рд╢реНрд╡рд╛рд╕', 'рдЬрдорд▓рд╛', 'рдирд╛рддрдВ', 'рд╣реЛрдИрд▓']
                if any(indicator in text for indicator in marathi_specific):
                    best_lang = 'mr'
                    confidence += 2  # Boost confidence for Marathi
                    conf_level = 'medium'
                    method = 'marathi_fallback'
                else:
                    method = 'custom_detection'
            else:
                method = 'custom_detection'
            
            return best_lang, confidence, method, {
                'matched_indicators': matched_indicators.get(best_lang, []),
                'all_scores': lang_scores,
                'confidence_level': conf_level
            }
        
        # If no clear indicators, use heuristic based on common patterns
        # Default to Hindi for Devanagari text (most common)
        return 'hi', 0, 'default_heuristic', {
            'matched_indicators': [],
            'all_scores': {},
            'confidence_level': 'very_low'
        }

    def detect_language(self, text):
        """
        Smart hybrid language detection with enhanced Devanagari handling
        Returns: language_code
        """
        if not text or len(text.strip()) < 2:
            return 'hin_Deva'

        # Step 1: Check if it's Devanagari script
        if self.is_devanagari_script(text):
            print("ЁЯФН Detected Devanagari script - using enhanced custom detection")
            
            # Count Devanagari words to determine if it's predominantly Devanagari
            devanagari_word_count = self.count_devanagari_words(text)
            total_words = len(text.split())
            devanagari_ratio = devanagari_word_count / total_words if total_words > 0 else 0
            
            # If less than 20% of words are Devanagari, it's likely mixed content
            if devanagari_ratio < 0.2:
                print(f"тЪая╕П Low Devanagari ratio ({devanagari_ratio:.2f}), treating as mixed content")
                # Try langdetect for the dominant language
                try:
                    detected_lang = detect(text)
                    if detected_lang in self.lang_code_map:
                        print(f"ЁЯМР Using langdetect result for mixed content: {detected_lang}")
                        return self.lang_code_map[detected_lang]
                except:
                    pass
                return 'eng_Latn'  # Default to English for mixed content
            
            # Use enhanced Devanagari detection
            devanagari_lang, confidence, method, details = self.detect_devanagari_language(text)
            
            print(f"тЬЕ Custom detection: {devanagari_lang} (confidence: {confidence}, method: {method})")
            print(f"   Matched indicators: {details.get('matched_indicators', [])[:5]}...")  # Show first 5
            
            return self.lang_code_map[devanagari_lang]
        
        # Step 2: For non-Devanagari scripts, use langdetect
        try:
            detected_lang = detect(text)
            print(f"ЁЯМР Langdetect result: {detected_lang}")
            
            if detected_lang in self.lang_code_map:
                return self.lang_code_map[detected_lang]
            else:
                print(f"тЪая╕П  Langdetect returned unsupported language: {detected_lang}")
                return 'hin_Deva'  # Fallback
                
        except LangDetectException:
            print("тЭМ Langdetect failed, using fallback")
            return 'hin_Deva'  # Fallback

    def get_detection_method(self, text):
        """Get information about detection method used"""
        if self.is_devanagari_script(text):
            lang, confidence, method, details = self.detect_devanagari_language(text)
            return {
                'method': method,
                'detected_lang': lang,
                'confidence': confidence,
                'confidence_level': details.get('confidence_level', 'low'),
                'indicators_used': len(details.get('matched_indicators', [])),
                'matched_indicators': details.get('matched_indicators', [])
            }
        else:
            try:
                lang = detect(text)
                return {
                    'method': 'langdetect',
                    'detected_lang': lang,
                    'confidence': 'high'
                }
            except:
                return {
                    'method': 'fallback',
                    'detected_lang': 'hi',
                    'confidence': 'low'
                }